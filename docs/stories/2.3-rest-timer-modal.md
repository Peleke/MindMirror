# Story 2.3: Rest Timer as Modal (Simplified)

## Status
Draft

## Story
**As a** user
**I want** rest timer to appear as a modal overlay
**so that** it's prominent and matches modern fitness app patterns

**SCOPE NOTE:** Simplified for alpha - basic modal with countdown, skip complex circular progress

## Acceptance Criteria

1. Timer triggers automatically after completing a set (checkbox checked)
2. Modal appears centered with countdown (90s default), Skip/Add 30s buttons
3. Background dimmed (80% opacity black overlay)
4. Tapping outside modal does NOT dismiss (force user to interact with Skip)
5. ~~Circular progress ring~~ OPTIONAL - use simple countdown text if time-constrained
6. ~~Haptic feedback at 10s, 5s, 0s~~ DEFER - implement if time permits, not critical
7. Modal slides up with basic animation (300ms)

## Tasks / Subtasks

- [ ] Create rest timer modal component (AC: 2, 3, 4)
  - [ ] Create modal component (React Native Modal or custom implementation)
  - [ ] Add centered countdown display (large text, readable)
  - [ ] Add Skip and Add 30s buttons (clear, large touch targets)
  - [ ] Implement dimmed background overlay (80% opacity black)
  - [ ] Disable dismiss on background tap

- [ ] Implement countdown logic (AC: 2)
  - [ ] Use timer hook or setInterval for countdown (90s default)
  - [ ] Update countdown text every second
  - [ ] Handle Skip button (dismiss modal immediately)
  - [ ] Handle Add 30s button (add 30s to current time)

- [ ] Trigger modal on set completion (AC: 1)
  - [ ] Hook into completion checkbox from Story 2.2
  - [ ] Show modal when checkbox checked
  - [ ] Auto-dismiss when countdown reaches 0

- [ ] Add modal animation (AC: 7)
  - [ ] Implement slide-up animation (300ms)
  - [ ] Use React Native Animated API or Modal animationType prop

- [ ] (OPTIONAL) Add circular progress ring (AC: 5)
  - [ ] **Only if time permits** - use react-native-circular-progress or custom SVG
  - [ ] Skip if approaching 1.5 hour time limit

- [ ] (OPTIONAL) Add haptic feedback (AC: 6)
  - [ ] **Only if time permits** - use react-native-haptic-feedback
  - [ ] Skip if approaching 1.5 hour time limit

## Dev Notes

### Relevant Source Tree
- **Component:** Create new `mindmirror-mobile/components/RestTimerModal.tsx`
- **Integration:** `mindmirror-mobile/app/(app)/client/[id].tsx` (trigger from workout screen)
- **Styling:** React Native Modal, StyleSheet

### Key Technical Details
- React Native Modal component provides built-in overlay functionality
- Modal `animationType` can be "slide" for simple slide-up animation
- Timer state management: useState + useEffect or custom hook
- Default rest time: 90 seconds (configurable later)

### Implementation Notes
- Keep it simple - prominent countdown text is more important than circular progress
- Buttons should be large and clearly labeled (Skip vs Add 30s)
- Consider making rest time configurable per exercise (future feature, use 90s default for alpha)
- Handle edge case: User backgrounds app mid-rest (timer should pause or continue based on UX preference)

### ALPHA SPEED FOCUS
- **What to cut if running over time:** Circular progress (AC 5), Haptic feedback (AC 6)
- **Non-negotiable:** Modal overlay, countdown text, Skip/Add 30s buttons, auto-trigger

### Testing
**Test file location:** `mindmirror-mobile/__tests__/components/RestTimerModal.test.tsx`

**Test standards:**
- Unit tests for countdown logic
- Integration test for modal trigger on set completion
- Manual testing for modal UX (dismiss behavior, button interactions)

**Testing frameworks:**
- Jest + React Native Testing Library
- Manual device testing for UX validation

**Specific testing requirements:**
- Test modal appears when set completed
- Test countdown decrements correctly
- Test Skip button dismisses modal
- Test Add 30s button adds time
- Test background tap does NOT dismiss
- Test modal auto-dismisses at 0 seconds

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-15 | v1.0 | Initial story creation from Epic 2 (reduced scope) | Sarah (PO Agent) |

## Dev Agent Record

### Agent Model Used
_To be populated by dev agent_

### Debug Log References
_To be populated by dev agent_

### Completion Notes
_To be populated by dev agent_

### File List
_To be populated by dev agent_

## QA Results
_To be populated by QA agent_
